<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Building Intelligent Agents for Connect-4: First Steps | Markus Thill </title> <meta name="author" content="Markus Thill"> <meta name="description" content="A deep dive into the construction of intelligent agents for Connect-4. This introductory post covers the historical context, motivation, complexity of the game, and foundational concepts behind AI-based approaches—particularly tree search and reinforcement learning methods. Includes a preview of the full 7-part series and links to an open-source Python3/C++ framework."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8D%95&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://markusthill.github.io/blog/2025/connect-4-introduction-and-tree-search-algorithms/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Markus</span> Thill </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"> </a> </li> <li class="nav-item "> <a class="nav-link" href="/about">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Building Intelligent Agents for Connect-4: First Steps</h1> <p class="post-meta"> Created on July 04, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/connect-4"> <i class="fa-solid fa-hashtag fa-sm"></i> Connect-4</a>   <a href="/blog/tag/ai"> <i class="fa-solid fa-hashtag fa-sm"></i> AI</a>   <a href="/blog/tag/tree-search"> <i class="fa-solid fa-hashtag fa-sm"></i> tree-search</a>   <a href="/blog/tag/alpha-beta"> <i class="fa-solid fa-hashtag fa-sm"></i> alpha-beta</a>   <a href="/blog/tag/minimax"> <i class="fa-solid fa-hashtag fa-sm"></i> minimax</a>   <a href="/blog/tag/transposition-tables"> <i class="fa-solid fa-hashtag fa-sm"></i> transposition tables</a>   <a href="/blog/tag/opening-databases"> <i class="fa-solid fa-hashtag fa-sm"></i> opening databases</a>   <a href="/blog/tag/move-ordering"> <i class="fa-solid fa-hashtag fa-sm"></i> move ordering</a>   <a href="/blog/tag/bitboards"> <i class="fa-solid fa-hashtag fa-sm"></i> bitboards</a>   ·   <a href="/blog/category/programming"> <i class="fa-solid fa-tag fa-sm"></i> Programming</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h2"><a href="#introduction">Introduction</a></li> <li class="toc-entry toc-h2"><a href="#connect-4">Connect-4</a></li> <li class="toc-entry toc-h2"> <a href="#a-connect-4-agent-based-on-tree-search-techniques">A Connect-4 Agent Based on Tree-Search Techniques</a> <ul> <li class="toc-entry toc-h3"><a href="#summary-of-the-upcoming-blog-posts">Summary of the Upcoming Blog Posts</a></li> <li class="toc-entry toc-h3"><a href="#bitboards-for-fast-and-efficient-board-representation">Bitboards for Fast and Efficient Board Representation</a></li> <li class="toc-entry toc-h3"><a href="#performance-highlights">Performance Highlights</a></li> </ul> </li> <li class="toc-entry toc-h2"><a href="#bitbully-a-high-speed-connect-4-solver">BitBully: A High-Speed Connect-4 Solver</a></li> <li class="toc-entry toc-h2"><a href="#connect-4-java-framework">Connect-4 Java Framework</a></li> <li class="toc-entry toc-h2"><a href="#references">References</a></li> <li class="toc-entry toc-h2"><a href="#counting-positions-on-the-connect-4-board-with-12-and-less-plies">Counting Positions on the Connect-4 Board with 12 and less Plies</a></li> </ul> </div> <hr> <div id="markdown-content"> <p>This post is the 1st part of a series of 7 articles:</p> <ol> <li><strong><a href="/blog/2025/connect-4-introduction-and-tree-search-algorithms/">Building Intelligent Agents for Connect-4: First Steps</a></strong></li> <li><a href="/blog/2025/connect-4-tree-search-algorithms/">Building Intelligent Agents for Connect-4: Tree Search Algorithms</a></li> <li><a href="#">Building Intelligent Agents for Connect-4: Board Representations</a></li> <li><a href="#">Building Intelligent Agents for Connect-4: Move Ordering</a></li> <li><a href="#">Building Intelligent Agents for Connect-4: Transposition Tables</a></li> <li><a href="#">Building Intelligent Agents for Connect-4: Opening Databases</a></li> <li><a href="#">Building Intelligent Agents for Connect-4: Final Considerations</a></li> </ol> <p>The study of strategic board games is a long-standing and foundational area of research in artificial intelligence (AI). Over the years, countless approaches have been explored—often with very different goals and methodologies. Complex games such as chess, Go, and checkers have traditionally attracted significant attention due to their strategic depth and computational challenges.</p> <p>In this blog post—and in future entries—we’ll turn our attention to <em>Connect-4</em>. While simpler than the aforementioned classics, Connect-4 still offers interesting AI challenges. We’ll explore various techniques for building strong-playing agents, ranging from handcrafted heuristics to learning-based and search-based methods.</p> <p>More recently, I developed a high-performance C++ and Python version of a Connect-4 solver called <strong>BitBully</strong>, available <a href="https://github.com/MarkusThill/BitBully" rel="external nofollow noopener" target="_blank">here</a> and <a href="https://pypi.org/project/bitbully/" rel="external nofollow noopener" target="_blank">here</a>. Also, check out the related <a href="https://markusthill.github.io/projects/0_bitbully/" rel="external nofollow noopener" target="_blank">project page</a>.</p> <p>For those interested in a more educational or research-oriented setup, an earlier Java-based framework for <em>Connect-4</em> is also available on GitHub: <a href="http://github.com/MarkusThill/Connect-Four" rel="external nofollow noopener" target="_blank">http://github.com/MarkusThill/Connect-Four</a>.</p> <p><br></p> <h2 id="introduction">Introduction</h2> <p>For decades, researchers have been fascinated by the question of whether machines can one day achieve a level of intelligence comparable to that of humans. This pursuit spans many fields, but one of the most established areas in artificial intelligence (AI) has been the development of intelligent programs capable of solving well-defined problems—strategic board games being a prime example.</p> <p>The term <em>artificial intelligence</em> itself is difficult to pin down precisely, since even “intelligence” remains a debated and multifaceted concept. One influential definition comes from computer scientist John McCarthy, who described AI as:</p> <blockquote> <p><em>“The science and engineering of making intelligent machines, especially intelligent computer programs. It is related to the similar task of using computers to understand human intelligence, but AI does not have to confine itself to methods that are biologically observable.”</em></p> </blockquote> <p>Strategic board games have long played a central role in AI research. Over the past 70 years, a vast body of work has investigated the development of machine players, each with different objectives and methods. Early efforts focused particularly on chess, where programs evolved from simple evaluation functions to systems capable of defeating world champions.</p> <p>A historical curiosity is the so-called <em>Mechanical Turk</em>, built in 1769 by Austrian-Hungarian inventor Wolfgang von Kempelen. Claimed to be an automated chess-playing machine, it captivated audiences across Europe—until it was later revealed that a human operator was hidden inside. Much later, during World War II, Konrad Zuse designed the first known chess program using his own programming language <em>Plankalkül</em>.</p> <p>Milestones like IBM’s <em>Deep Blue</em> defeating world champion Garry Kasparov in 1997 showcased the potential of brute-force search, leveraging custom hardware to evaluate over 2 million positions per second. Since then, AI research has moved toward even more sophisticated approaches, incorporating learning and generalization.</p> <p>So why have board games become such a fertile ground for AI research?</p> <p>Several properties make them especially appealing:</p> <ul> <li> <strong>Well-defined rules and goals</strong>: Most games have a fixed structure and a clearly defined win/loss condition. Unlike many real-world problems, the rules do not change mid-game.</li> <li> <strong>Discrete and fully observable environments</strong>: The current state of the game is fully known at all times, and transitions between states are (usually) deterministic.</li> <li> <strong>Manageable complexity with scalable difficulty</strong>: Despite their simplicity in terms of rules, many games have enormous state and action spaces, which demand clever search or learning strategies.</li> <li> <strong>Relevance to broader AI problems</strong>: Concepts such as planning, decision-making, adversarial search, and pattern recognition all play a role.</li> </ul> <p>Humans excel at recognizing patterns, drawing analogies, and applying prior knowledge to new situations. For example, identifying familiar faces in photos or spotting tactical motifs in a chess position comes naturally to us. For machines, these tasks are far more difficult. Early AI systems in board games mostly relied on brute-force tree search and clever pruning. While effective, these systems lacked the ability to learn from experience in the human sense.</p> <p>Machine learning methods, particularly <em>Reinforcement Learning (RL)</em> and <em>Temporal Difference Learning (TDL)</em>, offer a different paradigm. In RL, an agent learns through interaction with its environment, receiving rewards based on outcomes. Over time, the agent develops a value function that helps evaluate positions and guide future decisions. Crucially, this process can allow the agent to improve its play autonomously—without relying on handcrafted rules or features.</p> <p>However, even modern learning systems often depend on carefully chosen features to represent game states. Selecting and engineering these features is itself a creative challenge and can significantly impact performance.</p> <p>In this blog series, we’ll begin by exploring classical tree search algorithms and heuristics before diving into more advanced, learning-based approaches to mastering board games—starting with <em>Connect-4</em>, a seemingly simple yet deeply strategic game.</p> <h2 id="connect-4">Connect-4</h2> <p><em>Connect-4</em> is a widely known two-player board game, typically played with the colors <em>Yellow</em> and <em>Red</em>, on a vertical grid consisting of seven columns and six rows. At the start of the game, the board is completely empty, offering 42 available positions.</p> <p>One of the defining characteristics of <em>Connect-4</em> is its vertical layout: players can only <strong>drop</strong> their discs into the top of a column. Due to gravity, a token always occupies the <strong>lowest unfilled row</strong> of the selected column. If a column is already filled with six tokens, no further moves can be made in that column, reducing the number of available options for both players.</p> <p>Players alternate turns, starting with Yellow, aiming to create a line of four connected tokens of their own color. These four aligned discs may appear:</p> <ul> <li><strong>Horizontally</strong></li> <li><strong>Vertically</strong></li> <li> <strong>Diagonally</strong> (in either direction)</li> </ul> <p>The first player to align four of their tokens in a row wins the game. If neither player manages to achieve this by the time all 42 cells are filled, the game ends in a draw.</p> <p>Below is an example board position illustrating the game’s mechanics and strategic possibilities:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2025-07-04-connect-4-introduction-and-tree-search-algorithms/C4-example-position-480.webp 480w,/assets/img/2025-07-04-connect-4-introduction-and-tree-search-algorithms/C4-example-position-800.webp 800w,/assets/img/2025-07-04-connect-4-introduction-and-tree-search-algorithms/C4-example-position-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2025-07-04-connect-4-introduction-and-tree-search-algorithms/C4-example-position.png" class="img-fluid rounded z-depth-1 imgcenter" width="50%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> <figcaption class="caption"> <b>Figure 1:</b> Typical <em>Connect-4</em> position, created during a match of a temporal difference learning agent (Yellow) against a perfect playing Minimax agent (Red), with Minimax as the next player to move. Both types of agents will be described in later posts. For the given position, Minimax is under zugzwang and will eventually loose the game, however, the defeat could be delayed as far as possible. </figcaption> </figure> <p>Although <em>Connect-4</em> has a <strong>moderate state-space complexity</strong> of approximately<br> \(4.5 \cdot 10^{12}\) distinct positions <a class="citation" href="#Edelkamp08">(Edelkamp &amp; Kissmann, 2008)</a>, and a <strong>game-tree complexity</strong> around<br> \(10^{21}\) <a class="citation" href="#Allis94">(Allis, 1994)</a>, solving the game remains a non-trivial challenge even today.</p> <p>The first known solution was independently discovered by Allen <a class="citation" href="#Allen89">(Allen, 1989)</a> and Allis <a class="citation" href="#Allis88">(Allis, 1988)</a> in 1988. They <em>weakly solved</em> the game, demonstrating that—assuming perfect play from both players—<strong>Yellow can always force a win</strong> if she starts by placing her first token in the <strong>center column</strong>. While Red cannot win under optimal play, she can <strong>delay defeat</strong> and force Yellow to use all available moves.</p> <p>In 1994, Tromp <a class="citation" href="#Tromp94">(Bache &amp; Lichman, 2013)</a> went further and <em>strongly solved</em> the game for all positions with <strong>exactly 8 tokens</strong>, building a comprehensive endgame database that contains the game-theoretic values (win/loss/draw) of all <strong>non-trivial</strong> configurations.</p> <blockquote> <p><strong>Note:</strong> Tromp considered a position <em>trivial</em> if it contained an immediate win. While this is reasonable when Yellow has a direct winning move, it is debatable for Red: Red’s threats can often be neutralized by Yellow, allowing the game to proceed. Hence, the definition of triviality in this context is not entirely accurate.</p> </blockquote> <p>Tromp’s computation evaluated all <strong>67,557</strong> relevant positions and took approximately <strong>40,000 CPU hours</strong>—equivalent to about <strong>4.5 years</strong> of computation time.</p> <p>The table below shows the <strong>state-space complexity</strong> and <strong>leaf node counts</strong> for different numbers of plies. For instance, even with just <strong>12 tokens placed</strong> (i.e., after 12 plies), the state-space complexity is still about<br> \(2.5 \cdot 10^5\) times smaller than that of the complete 42-token game<br> (final value from <a class="citation" href="#Edelkamp08">(Edelkamp &amp; Kissmann, 2008)</a>).</p> <p>The source code used to generate the table is available in the appendix and on GitHub (<a href="https://github.com/MarkusThill/BitBully?tab=readme-ov-file#further-usage-examples-for-bitbully-core" rel="external nofollow noopener" target="_blank">Python</a> or <a href="https://github.com/MarkusThill/Connect-Four/blob/master/CFour/src/miscellaneous/CountPositionsC4.java" rel="external nofollow noopener" target="_blank">Java</a>).</p> <table> <tbody> <tr> <td>Plies</td> <td>Leaf Nodes</td> <td>State-Space Complexity</td> </tr> <tr> <td>0</td> <td>1</td> <td>1</td> </tr> <tr> <td>1</td> <td>7</td> <td>8</td> </tr> <tr> <td>2</td> <td>49</td> <td>57</td> </tr> <tr> <td>3</td> <td>238</td> <td>295</td> </tr> <tr> <td>4</td> <td>1,120</td> <td>1,415</td> </tr> <tr> <td>5</td> <td>4,263</td> <td>5,678</td> </tr> <tr> <td>6</td> <td>16,422</td> <td>22,100</td> </tr> <tr> <td>7</td> <td>53,955</td> <td>76,055</td> </tr> <tr> <td>8</td> <td>181,597</td> <td>257,652</td> </tr> <tr> <td>9</td> <td>534,085</td> <td>791,737</td> </tr> <tr> <td>10</td> <td>1,602,480</td> <td>2,394,217</td> </tr> <tr> <td>11</td> <td>4,231,877</td> <td>6,626,094</td> </tr> <tr> <td>12</td> <td>11,477,673</td> <td>18,102,767</td> </tr> <tr> <td>\(\vdots\)</td> <td>\(\vdots\)</td> <td>\(\vdots\)</td> </tr> <tr> <td>42</td> <td>?</td> <td>\(4,531,985,219,092 \approx 4.5 \times 10^{12}\)</td> </tr> </tbody> </table> <p>You can also find the list with up to 26 plies on <a href="https://oeis.org/A212693" rel="external nofollow noopener" target="_blank">OEIS</a>.</p> <p><br></p> <h2 id="a-connect-4-agent-based-on-tree-search-techniques">A Connect-4 Agent Based on Tree-Search Techniques</h2> <h3 id="summary-of-the-upcoming-blog-posts">Summary of the Upcoming Blog Posts</h3> <p>Some time ago, I developed a <em>perfect-playing</em> Connect-4 agent. The project began with a simple <strong>Minimax</strong> agent—a classic tree-search algorithm—and was gradually refined with a series of optimizations. The final version integrates advanced search techniques and is supported by comprehensive databases to master the game’s opening phase.</p> <p>For <em>Connect-4</em>, we benefit from <strong>Tromp’s 8-ply opening database</strong>, which I further extended to include all 8-ply positions with <em>immediate threats for Yellow</em>, as these were originally omitted. Additionally, I generated a <strong>Huffman-encoded endgame database</strong> covering all positions with <strong>exactly 12 tokens</strong>, storing both the expected outcome and the precise number of moves remaining until the end of the game (under perfect play).</p> <p>The core <strong>Minimax search</strong> is enhanced with several techniques:</p> <ul> <li><strong>Alpha-Beta Pruning</strong></li> <li><strong>Move Ordering</strong></li> <li><strong>Symmetry Exploitation</strong></li> <li><strong>Zobrist Hashing</strong></li> <li> <strong>Two-Stage Transposition Tables</strong> to detect repeated positions from different move orders</li> <li><strong>Enhanced Transposition Cutoffs (ETC)</strong></li> </ul> <h3 id="bitboards-for-fast-and-efficient-board-representation">Bitboards for Fast and Efficient Board Representation</h3> <p>The agent uses <strong>bitboards</strong> as the main data structure for board representation. In this scheme, each <em>Connect-4</em> cell is encoded using <strong>two bitfields</strong>, one per player, requiring a total of<br> \(2 \times 42 = 84\) bits to represent a position. With a well-chosen layout of cells in memory, common operations become extremely efficient thanks to native CPU support for bitwise instructions (e.g., AND, OR, XOR, bit shifts).</p> <p>Typical board operations—such as placing/removing tokens, mirroring, rotation, copying, and detecting terminal states—can be performed significantly faster with bitboards than with traditional structures like 2D arrays.</p> <p>In particular, <strong>terminal state detection</strong> (i.e., checking for 4-in-a-row) is a time-critical task in Connect-4. With bitboards, a highly optimized solution exists that vastly outperforms conventional implementations. Moreover, bitboards are memory-efficient, which is crucial when storing millions of positions in transposition tables.</p> <h3 id="performance-highlights">Performance Highlights</h3> <p>Thanks to all these optimizations, the agent ranks among the <strong>fastest perfect-playing Connect-4 solvers</strong>:</p> <ul> <li>On a vintage <strong>Pentium-4</strong> machine, it can solve the empty board in under <strong>4 minutes</strong>, <em>without</em> using any opening database and with just <strong>24 MB of transposition table memory</strong>.</li> <li>In the typical configuration—using a <strong>12-ply opening database</strong> and the same <strong>24 MB transposition table</strong>—most positions can be solved in a <strong>fraction of a second</strong>.</li> </ul> <hr> <p>These techniques will be explored in greater detail in the upcoming blog posts.</p> <p><br></p> <ul id="log" class="tab" data-tab="b992d79e-d952-4058-bc7a-2dbf70a6c187" data-name="log"> <li class="active" id="log-python-c--"> <a href="#">Python/C++ </a> </li> <li id="log-java"> <a href="#">Java </a> </li> </ul> <ul class="tab-content" id="b992d79e-d952-4058-bc7a-2dbf70a6c187" data-name="log"> <li class="active"> <h2 id="bitbully-a-high-speed-connect-4-solver">BitBully: A High-Speed Connect-4 Solver</h2> <p><strong>BitBully</strong> is a blazing-fast, perfect-playing <em>Connect-4</em> solver written in <strong>C++</strong> with seamless <strong>Python bindings</strong>. Designed for both developers and researchers, it offers a powerful toolkit for analyzing game-theoretic strategies and solving arbitrary board positions with high efficiency.</p> <p>Key features include:</p> <ul> <li> <strong>Bitboard Engine</strong> using low-level bitwise operations</li> <li> <strong>MTD(f)</strong> and <strong>null-window search</strong> for fast perfect-play solving</li> <li> <strong>Opening database</strong> covering all positions up to 12 discs</li> <li> <strong>Advanced heuristics</strong>: threat detection, transposition tables, move ordering</li> <li> <strong>Cross-platform</strong> (Linux, Windows, macOS) with zero-setup Python wheels</li> <li> <strong>Open Source</strong> under the AGPL-3.0 license</li> </ul> <p>Available here:<br> 👉 <a href="https://github.com/MarkusThill/BitBully" rel="external nofollow noopener" target="_blank">GitHub</a> · <a href="https://pypi.org/project/bitbully" rel="external nofollow noopener" target="_blank">PyPI</a> · <a href="https://markusthill.github.io/BitBully" rel="external nofollow noopener" target="_blank">Docs</a></p> <p>Also, check out the related <a href="https://markusthill.github.io/projects/0_bitbully/" rel="external nofollow noopener" target="_blank">project page</a>.</p> </li> <li> <h2 id="connect-4-java-framework">Connect-4 Java Framework</h2> <p>A comprehensive software framework for <em>Connect-4</em> implemented in <strong>Java</strong> is available on GitHub. It provides a flexible environment for conducting learning experiments and evaluating different AI strategies.</p> <p>The framework includes a <strong>graphical user interface (GUI)</strong> that offers:</p> <ul> <li>Visual inspection of the game state and progress</li> <li>Tools for performance evaluation and analysis</li> <li>Import/export functionalities for game positions and statistics</li> <li>Interactive play between the user and various agents, including: <ul> <li>Random agents</li> <li>Temporal-Difference Learning (TDL) agents</li> <li>Minimax search agents</li> <li>Monte Carlo Tree Search (MCTS) agents</li> <li>And more</li> </ul> </li> </ul> <p>The framework is <strong>open-source</strong> and can be downloaded from:<br> 👉 <a href="http://github.com/MarkusThill/Connect-Four" rel="external nofollow noopener" target="_blank">github.com/MarkusThill/Connect-Four</a></p> </li> </ul> <p><br></p> <h2 id="references">References</h2> <div class="publications"> <ol class="bibliography"> <li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Edelkamp08" class="col-sm-8"> <div class="title">Symbolic classification of general two-player games</div> <div class="author"> Stefan Edelkamp and Peter Kissmann </div> <div class="periodical"> <em>In KI 2008: Advances in Artificial Intelligence</em>, 2008 </div> <div class="periodical"> </div> <div class="links"> </div> </div> </div> </li> <li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Allis94" class="col-sm-8"> <div class="title">Searching for Solutions in Games and Artificial Intelligence</div> <div class="author"> Victor L. Allis </div> <div class="periodical"> <em>University of Limburg</em>, 1994 </div> <div class="periodical"> </div> <div class="links"> </div> </div> </div> </li> <li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Allen89" class="col-sm-8"> <div class="title">A Note on the Computer Solution of Connect-4</div> <div class="author"> James D. Allen </div> <div class="periodical"> <em>In Heuristic Programming in AI 1: The First Computer Olympiad</em>, 1989 </div> <div class="periodical"> </div> <div class="links"> </div> </div> </div> </li> <li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Allis88" class="col-sm-8"> <div class="title">A knowledge-based approach of Connect-4. The game is solved: White wins</div> <div class="author"> Victor L. Allis </div> <div class="periodical"> <em>Department of Mathematics and Computer Science, Vrije Universiteit, Amsterdam, The Netherlands</em>, 1988 </div> <div class="periodical"> </div> <div class="links"> </div> </div> </div> </li> <li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Tromp94" class="col-sm-8"> <div class="title">UCI Machine Learning Repository. Tromp’s 8-ply database</div> <div class="author"> K. Bache and M. Lichman </div> <div class="periodical"> 2013 </div> <div class="periodical"> </div> <div class="links"> </div> </div> </div> </li> </ol> </div> <h2 id="counting-positions-on-the-connect-4-board-with-12-and-less-plies">Counting Positions on the Connect-4 Board with 12 and less Plies</h2> <ul id="count" class="tab" data-tab="011d0aa6-b99e-4847-b8bf-1d58462c4790" data-name="count"> <li class="active" id="count-python"> <a href="#">Python </a> </li> <li id="count-java"> <a href="#">Java </a> </li> </ul> <ul class="tab-content" id="011d0aa6-b99e-4847-b8bf-1d58462c4790" data-name="count"> <li class="active"> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">bitbully</span> <span class="kn">import</span> <span class="n">bitbully_core</span> <span class="k">as</span> <span class="n">bbc</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">bbc</span><span class="p">.</span><span class="nc">Board</span><span class="p">()</span>  <span class="c1"># empty board
</span><span class="n">board_list_3ply</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="nf">allPositions</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>  <span class="c1"># All positions with exactly 3 tokens
</span><span class="nf">len</span><span class="p">(</span><span class="n">board_list_3ply</span><span class="p">)</span>  <span class="c1"># should be 238 according to https://oeis.org/A212693
</span></code></pre></div></div> </li> <li> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">package</span> <span class="nn">miscellaneous</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">c4.ConnectFour</span><span class="o">;</span>

<span class="cm">/**
 * * Always do 3 runs for counting the positions. First, count all positions
 * with a yellow stone in the left-bottom-corner, then with a red stone, and
 * last run when left-bottom-corner is empty. This is done, because the Hashset
 * can be reset after each run, and doesn't need that much memory.
 * 
 * @author Markus Thill
 * 
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountPositionsC4</span> <span class="kd">extends</span> <span class="nc">ConnectFour</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">maxDepth</span> <span class="o">=</span> <span class="mi">6</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">boolean</span> <span class="n">countAll</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
	<span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">LongArr</span><span class="o">&gt;</span> <span class="n">hs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">LongArr</span><span class="o">&gt;(</span><span class="mi">16777216</span><span class="o">);</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="no">MASK</span> <span class="o">=</span> <span class="mh">0x20000000000</span><span class="no">L</span><span class="o">;</span>
	<span class="kt">int</span> <span class="n">run</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">tree</span><span class="o">(</span><span class="kt">int</span> <span class="n">depth</span><span class="o">,</span> <span class="kt">int</span> <span class="n">player</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">depth</span> <span class="o">==</span> <span class="n">maxDepth</span> <span class="o">||</span> <span class="n">countAll</span><span class="o">)</span> <span class="o">{</span>

			<span class="kt">boolean</span> <span class="n">putElement</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
			<span class="k">switch</span> <span class="o">(</span><span class="n">run</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="c1">// yellow stone in bottom-left corner</span>
				<span class="n">putElement</span> <span class="o">=</span> <span class="o">(</span><span class="n">fieldP1</span> <span class="o">&amp;</span> <span class="no">MASK</span><span class="o">)</span> <span class="o">==</span> <span class="no">MASK</span><span class="o">;</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="c1">// red stone in bottom-left corner</span>
				<span class="n">putElement</span> <span class="o">=</span> <span class="o">(</span><span class="n">fieldP2</span> <span class="o">&amp;</span> <span class="no">MASK</span><span class="o">)</span> <span class="o">==</span> <span class="no">MASK</span><span class="o">;</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="c1">// no stone in bottom-left corner</span>
				<span class="n">putElement</span> <span class="o">=</span> <span class="o">((</span><span class="n">fieldP1</span> <span class="o">|</span> <span class="n">fieldP2</span><span class="o">)</span> <span class="o">&amp;</span> <span class="no">MASK</span><span class="o">)</span> <span class="o">==</span> <span class="mh">0x0</span><span class="no">L</span><span class="o">;</span>
				<span class="k">break</span><span class="o">;</span>

			<span class="o">}</span>

			<span class="k">if</span> <span class="o">(</span><span class="n">putElement</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">LongArr</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LongArr</span><span class="o">(</span><span class="n">fieldP1</span><span class="o">,</span> <span class="n">fieldP2</span><span class="o">);</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">hs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
					<span class="n">count</span><span class="o">++;</span>
					<span class="k">if</span> <span class="o">((</span><span class="n">count</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="no">L</span><span class="o">)</span> <span class="o">==</span> <span class="mh">0xFFFF</span><span class="no">L</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Count until now: "</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">gc</span><span class="o">();</span>
					<span class="o">}</span>
				<span class="o">}</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">depth</span> <span class="o">==</span> <span class="n">maxDepth</span><span class="o">)</span>
				<span class="k">return</span><span class="o">;</span>
		<span class="o">}</span>

		<span class="kt">int</span> <span class="n">moves</span><span class="o">[]</span> <span class="o">=</span> <span class="n">generateMoves</span><span class="o">(</span><span class="n">player</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">moves</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">canWin</span><span class="o">(</span><span class="n">moves</span><span class="o">[</span><span class="n">i</span><span class="o">]))</span>
				<span class="k">return</span><span class="o">;</span>
			<span class="n">putPiece</span><span class="o">(</span><span class="n">player</span><span class="o">,</span> <span class="n">moves</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
			<span class="n">tree</span><span class="o">(</span><span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">player</span> <span class="o">==</span> <span class="no">PLAYER1</span> <span class="o">?</span> <span class="no">PLAYER2</span> <span class="o">:</span> <span class="no">PLAYER1</span><span class="o">);</span>
			<span class="n">removePiece</span><span class="o">(</span><span class="n">player</span><span class="o">,</span> <span class="n">moves</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * @param toPly
	 *            number of plys, for which number positions are calculated
	 * @param countAll
	 *            count all positions, not only leaf-nodes
	 */</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">countPositions</span><span class="o">(</span><span class="kt">int</span> <span class="n">toPly</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">countAll</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">resetBoard</span><span class="o">();</span>
		<span class="n">hs</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
		<span class="n">maxDepth</span> <span class="o">=</span> <span class="n">toPly</span><span class="o">;</span>
		<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">countAll</span> <span class="o">=</span> <span class="n">countAll</span><span class="o">;</span>

		<span class="k">for</span> <span class="o">(</span><span class="n">run</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">run</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">;</span> <span class="n">run</span><span class="o">++)</span> <span class="o">{</span>
			<span class="n">resetBoard</span><span class="o">();</span>
			<span class="n">hs</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
			<span class="n">maxDepth</span> <span class="o">=</span> <span class="n">toPly</span><span class="o">;</span>
			<span class="n">tree</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="no">PLAYER1</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="k">if</span> <span class="o">(!</span><span class="n">countAll</span><span class="o">)</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Number of different positions for exactly "</span>
					<span class="o">+</span> <span class="n">maxDepth</span> <span class="o">+</span> <span class="s">" stones: "</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s">""</span><span class="o">);</span>

		<span class="k">else</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Number of different positions with 0 to "</span>
					<span class="o">+</span> <span class="n">maxDepth</span> <span class="o">+</span> <span class="s">" stones: "</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s">""</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * @param plyRange
	 *            number of plys (range), for which number positions are
	 *            calculated
	 * @param countAll
	 *            count all positions, not only leaf-nodes
	 */</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">countPositions</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">plyRange</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">countAll</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">plyRange</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">plyRange</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="n">i</span><span class="o">++)</span>
			<span class="n">countPositions</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">countAll</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="kd">private</span> <span class="kd">class</span> <span class="nc">LongArr</span> <span class="o">{</span>
		<span class="kd">private</span> <span class="kt">long</span> <span class="n">arr</span><span class="o">[];</span>

		<span class="nc">LongArr</span><span class="o">(</span><span class="kt">long</span> <span class="n">val1</span><span class="o">,</span> <span class="kt">long</span> <span class="n">val2</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[]</span> <span class="o">{</span> <span class="n">val1</span><span class="o">,</span> <span class="n">val2</span> <span class="o">};</span>
		<span class="o">}</span>

		<span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
			<span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">hashCode</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">LongArr</span> <span class="n">o</span> <span class="o">=</span> <span class="o">(</span><span class="nc">LongArr</span><span class="o">)</span> <span class="n">obj</span><span class="o">;</span>
			<span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="n">o</span><span class="o">.</span><span class="na">arr</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">CountPositionsC4</span> <span class="n">cp</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CountPositionsC4</span><span class="o">();</span>
		<span class="n">cp</span><span class="o">.</span><span class="na">countPositions</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
		<span class="c1">// cp.countPositions(new int[]{0,9},false);</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div> </li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/online-batch-estimate-cov-mu/">Online and Batch-Incremental Estimation of Covariance Matrices and Means in Python</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/mahalanobis-distance/">The Relationship between the Mahalanobis Distance and the Chi-Squared Distribution</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/a-few-notes-on-the-runtime-complexity-of-latin-hypercube-sampling/">Notes on the Runtime Complexity of Latin Hypercube Sampling</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/mahalanobis-distance-implementations/">Implementing the Mahalanobis Distance in Python</a> </li> <div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;"> <br> <script defer src="/assets/js/giscus-setup.js"></script> <noscript> Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Markus Thill. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a> and from <a href="https://www.freepik.com/" rel="external nofollow noopener" target="_blank">Freepik</a>. Last updated: September 29, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?6bab9ec621eb188fdd3221e1f3861398"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/tabs.min.js?b8748955e1076bbe0dabcf28f2549fdc"></script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>